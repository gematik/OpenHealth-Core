use healthcard::command::apdu::{CardCommandApdu, CardResponseApdu};
use healthcard::exchange::channel::CardChannel;
use healthcard::exchange::{
    establish_secure_channel_with, get_random, read_vsd, retrieve_certificate, retrieve_certificate_from, verify_pin,
    CardAccessNumber, CardPin, CertificateFile, ExchangeError, HealthCardVerifyPinResult, SecureChannel,
};
use healthcard_apdu_base::{ReplaySession, Transcript};

struct ReplayChannel {
    session: ReplaySession,
}

impl ReplayChannel {
    fn from_transcript(transcript: Transcript) -> Self {
        Self { session: ReplaySession::from_transcript(transcript) }
    }
}

impl CardChannel for ReplayChannel {
    type Error = ExchangeError;

    fn supports_extended_length(&self) -> bool {
        self.session.supports_extended_length()
    }

    fn transmit(&mut self, command: &CardCommandApdu) -> Result<CardResponseApdu, Self::Error> {
        let tx = command.to_bytes();
        let rx = self.session.transmit_bytes(&tx).map_err(|err| ExchangeError::Transport {
            code: 0,
            message: err.to_string(),
        })?;
        CardResponseApdu::new(&rx).map_err(ExchangeError::from)
    }
}

fn establish_from_transcript(jsonl: &str) -> SecureChannel<ReplayChannel> {
    let transcript = Transcript::from_jsonl_str(jsonl).expect("load transcript");
    let can = transcript.can().expect("CAN in transcript");
    let card_access_number = CardAccessNumber::new(can).expect("CAN format");
    let mut generator = transcript
        .fixed_key_generator()
        .expect("keys parse")
        .expect("fixed key generator");
    let replay = ReplayChannel::from_transcript(transcript);
    establish_secure_channel_with(replay, &card_access_number, &mut generator).expect("replay establish secure channel")
}

#[test]
fn replay_establish_secure_channel() {
    let _channel = establish_from_transcript(JSONL_ESTABLISH_SECURE_CHANNEL);
}

#[test]
fn replay_verify_pin() {
    let mut channel = establish_from_transcript(JSONL_VERIFY_PIN);
    let pin = CardPin::new("123456").expect("valid PIN format");
    match verify_pin(&mut channel, &pin).expect("verify PIN") {
        HealthCardVerifyPinResult::Success(_) => {}
        HealthCardVerifyPinResult::WrongSecretWarning { retries_left, .. } => {
            panic!("PIN verification failed, retries left: {retries_left}");
        }
        HealthCardVerifyPinResult::CardBlocked(_) => panic!("PIN verification failed: card blocked"),
    }
}

#[test]
fn replay_get_random() {
    let mut channel = establish_from_transcript(JSONL_GET_RANDOM);
    let random = get_random(&mut channel, 32).expect("get random");
    assert_eq!(random.len(), 32);
}

#[test]
fn replay_read_vsd() {
    let mut channel = establish_from_transcript(JSONL_READ_VSD);
    let vsd = read_vsd(&mut channel).expect("read VSD");
    assert!(!vsd.is_empty());
}

#[test]
fn replay_retrieve_certificates() {
    let mut channel = establish_from_transcript(JSONL_READ_CERTS);
    let cert = retrieve_certificate(&mut channel).expect("retrieve default certificate");
    assert!(!cert.is_empty());

    let cv_cert = retrieve_certificate_from(&mut channel, CertificateFile::EgkAutCvcE256)
        .expect("retrieve CV certificate");
    assert!(!cv_cert.is_empty());
}

const JSONL_ESTABLISH_SECURE_CHANNEL: &str = r#"{"type":"header","version":1,"supports_extended_length":true,"keys":["99472E124DE0FC6E4D80C797FAB3E512CD70351F521DE5556AD4FB7491911BF7","7C33C0F7883452F90759A14EECEBEDA9890DD20304680372FE85EF7E67A80B45"],"can":"123123"}
{"type":"exchange","tx":"00A4040400","rx":"6282015A82017883023F008A01058407D2760001448000A181FA9103010501AB81908F0480FA0000A03CAF32A02BB4199501307F4C1306082A8214004C048119530700800000000000B406950130830114B406950130830118B803950110A40695010883011F8F04808400008C02808290008F0410EA00008F0400EA0000AF32A02BB406950130830113B406950130830118B4199501307F4C1306082A8214004C048119530700800000000000B8039501109103020501AB5B8F0410EA00008F0400EA0000AF32A02BB406950130830113B406950130830118B4199501307F4C1306082A8214004C048119530700800000000000B8039501108F0480840000AF9000"}
{"type":"exchange","tx":"00B09100000000","rx":"EF2BC003020000C103040502C210545359534954434F5345433230020400C403010000C503020000C7030100009000"}
{"type":"exchange","tx":"00A4020C02011C","rx":"9000"}
{"type":"exchange","tx":"00B00000000000","rx":"31143012060A04007F0007020204020202010202010D9000"}
{"type":"exchange","tx":"0022C1A40F800A04007F00070202040202830102","rx":"9000"}
{"type":"exchange","tx":"108600000000027C000000","rx":"7C12801096AB30ECC394284891D366125E04A6079000"}
{"type":"exchange","tx":"108600000000457C438141049C389D3E545C2C82F2FA3D335E84CBED509F62213EDF95474678B2405AE19DAE54153F22D499E217C5F43F2A0451C95E97D5B2EDB32A374A809F1B95B132DFCE0000","rx":"7C438241049E44D2012F111DC87665453DCAD5875799FB3830F85D6C1AA89B8BBB04B292065C134EAED66BB7AE28B6BFE96C3544232CBF3397658BEF85001AB314B8234E529000"}
{"type":"exchange","tx":"108600000000457C43834104231F205E8432E04687CBEF74159185449B89C16EED6ADE0DC65CC4839B038BBE7C09B3350AEE71A0AC31C0EAFDAA1C1714097DD1949328420E5449FC4493C2400000","rx":"7C43844104555A0E943EF0F39B5DE412E618AE59790069973C56C7009204B19701A97714F62363721EA76BDC33E77F08EB7A1D0439B124754AAAA4C20057CEE14849F8B3CF9000"}
{"type":"exchange","tx":"0086000000000C7C0A850810ED17B40867E53B0000","rx":"7C0A860825AD01DE59F88A7B9000"}
"#;

const JSONL_VERIFY_PIN: &str = r#"{"type":"header","version":1,"supports_extended_length":true,"keys":["93375C287BD80A761F420E43454176A998FB9A97DEA5A7502707C21503F1A765","3323B2073BE0658E0F6E697A3B2B2AA0FAA0B743996A22D7DB38ADE47CD7828B"],"can":"123123"}
{"type":"exchange","tx":"00A4040400","rx":"6282015A82017883023F008A01058407D2760001448000A181FA9103010501AB81908F0480FA0000A03CAF32A02BB4199501307F4C1306082A8214004C048119530700800000000000B406950130830114B406950130830118B803950110A40695010883011F8F04808400008C02808290008F0410EA00008F0400EA0000AF32A02BB406950130830113B406950130830118B4199501307F4C1306082A8214004C048119530700800000000000B8039501109103020501AB5B8F0410EA00008F0400EA0000AF32A02BB406950130830113B406950130830118B4199501307F4C1306082A8214004C048119530700800000000000B8039501108F0480840000AF9000"}
{"type":"exchange","tx":"00B09100000000","rx":"EF2BC003020000C103040502C210545359534954434F5345433230020400C403010000C503020000C7030100009000"}
{"type":"exchange","tx":"00A4020C02011C","rx":"9000"}
{"type":"exchange","tx":"00B00000000000","rx":"31143012060A04007F0007020204020202010202010D9000"}
{"type":"exchange","tx":"0022C1A40F800A04007F00070202040202830102","rx":"9000"}
{"type":"exchange","tx":"108600000000027C000000","rx":"7C128010E6D1421D67CBF018B966BF65C18DA2D99000"}
{"type":"exchange","tx":"108600000000457C43814104A8493EBD235ABDF8C1279040463C7D9D4680F6265BBA94AE2FF5EA893761A4FC9AC4B464CDE3CB6BF8343578FAC336CEC0DCD050F35292C442964EC3FF46B4240000","rx":"7C438241048DA08C6A1FBDCCB649BF5F4C8E0F1E373F79F0FA0BCD5CD2267D128F45144F850F3821D377CE902D2A50961D2F320CE7EE2C70F2EDAE8AAADA9F60375A5FEA2F9000"}
{"type":"exchange","tx":"108600000000457C4383410483F6492EAAADEFBD9172C8FAE9359A2D8DC2A4BA52F5356273F3BBD49844832D185D90DBA34F14DCA5CA8207B491B8CE8C8E6E6366FCFB16623C0FF94934A96C0000","rx":"7C438441049138B2B615218C9AEC3D5D828A28FD6A40594C03E64885FB4E3FD55DDB7A6E15574F9853550C480C6D4C34AE7B568A7634D197D3FCF0B8A01CB38F98D42CB01D9000"}
{"type":"exchange","tx":"0086000000000C7C0A8508585E7A2DF1A8E7600000","rx":"7C0A8608F4C8D0A6865C51119000"}
{"type":"exchange","tx":"0CA4040C0A8E08C0CA98B2E7F94D4700","rx":"990290008E089ED0FCE2BB08677E9000"}
{"type":"exchange","tx":"8C2000020A8E0837DA583C24CD668E00","rx":"990263C38E08EB5EA0B519CFE80863C3"}
{"type":"exchange","tx":"0C2000021D8711018C8B10EAF4A2D793E9B1D76763D05D748E08D6C0184D9A91548700","rx":"990290008E08A2A45A77205853C29000"}
"#;

const JSONL_GET_RANDOM: &str = r#"{"type":"header","version":1,"supports_extended_length":true,"keys":["178408E6CBC3C9C43848E6C6D797D9B5CC7ADA2426C566BF8EA85B6BC2400063","834E7850F1A56BF91EED9F3937E7A2B331FC3402F5A92C05D50CEEA9E0B7C866"],"can":"123123"}
{"type":"exchange","tx":"00A4040400","rx":"6282015A82017883023F008A01058407D2760001448000A181FA9103010501AB81908F0480FA0000A03CAF32A02BB4199501307F4C1306082A8214004C048119530700800000000000B406950130830114B406950130830118B803950110A40695010883011F8F04808400008C02808290008F0410EA00008F0400EA0000AF32A02BB406950130830113B406950130830118B4199501307F4C1306082A8214004C048119530700800000000000B8039501109103020501AB5B8F0410EA00008F0400EA0000AF32A02BB406950130830113B406950130830118B4199501307F4C1306082A8214004C048119530700800000000000B8039501108F0480840000AF9000"}
{"type":"exchange","tx":"00B09100000000","rx":"EF2BC003020000C103040502C210545359534954434F5345433230020400C403010000C503020000C7030100009000"}
{"type":"exchange","tx":"00A4020C02011C","rx":"9000"}
{"type":"exchange","tx":"00B00000000000","rx":"31143012060A04007F0007020204020202010202010D9000"}
{"type":"exchange","tx":"0022C1A40F800A04007F00070202040202830102","rx":"9000"}
{"type":"exchange","tx":"108600000000027C000000","rx":"7C128010ACCD5E43960AC3DF4302A62CD26DFBC59000"}
{"type":"exchange","tx":"108600000000457C438141041A94F01072AB063CFD0366911E2531CBE8EB1354A226D14FAEA4BBD58EF7EEA007B156486D61CA026A02B2949B23D0CD6DBD533F6D0BF8001C9F620F9C58F95D0000","rx":"7C4382410497E8FE9044641B3BA8464B0796C15A85798843A962D8703AB744645AC43A9B28679B70F398A5DCE470FB63A311AB5BB709FB52D0910FDBF8E197AE4E1985AE149000"}
{"type":"exchange","tx":"108600000000457C43834104914EE7511DFF513C8C1FB32C4F05F548A8F1BAD3C0C315511435612B20F4F1ED649617651AA88D81922B13FDFEEB711AE2F8749C480579778D2D3A713447AF050000","rx":"7C4384410484861B650341451EAD8B896A3077D04F6249E571D5064639AD886A76AEEB10164A28299F2DF76B23D5E0DA1B65A16FBAB1E6B1127B10E7A1D9A5D65BDEAFADC59000"}
{"type":"exchange","tx":"0086000000000C7C0A850897D09AEC4E23CDDC0000","rx":"7C0A8608ADE7C2DF158AE3849000"}
{"type":"exchange","tx":"0CA4040C0A8E08B49D4466E12206E100","rx":"990290008E08E2D6AF55CA02F0A09000"}
{"type":"exchange","tx":"8C84000000000D9701208E08EC90DB99F67E54F70000","rx":"8731019608D04F2D57FD8E0FEF87F4EC242E71C842211331D77DB0D60ADB373D4998AE217D928E969846D7837FC19EE62D8A0E990290008E08CED696693974B5C29000"}
"#;

const JSONL_READ_VSD: &str = r#"{"type":"header","version":1,"supports_extended_length":true,"keys":["0FB961D0B3F14EB4C97C5D3818D1217DF815BB76DBE086DEE61B6073E935F1A4","6B4FD168C9113727ABEDF35664C474F716A6A3F2916C2466D02D0F73D044D1D4"],"can":"123123"}
{"type":"exchange","tx":"00A4040400","rx":"6282015A82017883023F008A01058407D2760001448000A181FA9103010501AB81908F0480FA0000A03CAF32A02BB4199501307F4C1306082A8214004C048119530700800000000000B406950130830114B406950130830118B803950110A40695010883011F8F04808400008C02808290008F0410EA00008F0400EA0000AF32A02BB406950130830113B406950130830118B4199501307F4C1306082A8214004C048119530700800000000000B8039501109103020501AB5B8F0410EA00008F0400EA0000AF32A02BB406950130830113B406950130830118B4199501307F4C1306082A8214004C048119530700800000000000B8039501108F0480840000AF9000"}
{"type":"exchange","tx":"00B09100000000","rx":"EF2BC003020000C103040502C210545359534954434F5345433230020400C403010000C503020000C7030100009000"}
{"type":"exchange","tx":"00A4020C02011C","rx":"9000"}
{"type":"exchange","tx":"00B00000000000","rx":"31143012060A04007F0007020204020202010202010D9000"}
{"type":"exchange","tx":"0022C1A40F800A04007F00070202040202830102","rx":"9000"}
{"type":"exchange","tx":"108600000000027C000000","rx":"7C1280107E4A8746A6C64DBD3CB345234B2B12A09000"}
{"type":"exchange","tx":"108600000000457C438141040A4CC7A7044900B4C18653C1310586E132194F68A502A13B7DF9503AC51733A1548A41B7910686E021D175FB34F7DF1CBAFC3855E4D9257BAFE23D93DE2A7EE10000","rx":"7C43824104281C5CDCFD410258FE0D98B8A7F82B3C0984B567703806AB75450FE0CF9A42F68145A8F163386AAC92E0442A6EA7DC9DB1F13F9BC8457D36ED5B41673E7B2AF69000"}
{"type":"exchange","tx":"108600000000457C4383410472B65456E2F05B66F52758835761289292B0E92BB8DAC1922584B89DC4DBCE4C9D68B24A6A427D4A90201348AB86310AD45C2728A3F09BD74A223FFE8B54CA8F0000","rx":"7C4384410420EED1E92DF6AB834244A24F6A33C046A27617E2489345FD86A282A2808A128F05EBBCB1A8C80C7ECB3B19491DE773CC9DD74086490606223E902FABBF8EC6E99000"}
{"type":"exchange","tx":"0086000000000C7C0A8508BE12BC3D96C0944E0000","rx":"7C0A860811A755A83F5BC65D9000"}
{"type":"exchange","tx":"0CA4040C0A8E08EB4963AB4A4A925E00","rx":"990290008E086F0E0EBF300128A19000"}
{"type":"exchange","tx":"0CA4040C1D871101E6203958340658C7AD06A2D413613FD38E08BFB92FA6D74A4B9700","rx":"990290008E08ACF202A1E5FCD18C9000"}
{"type":"exchange","tx":"0CA4020C1D8711017C71B83BBCFFD6F1BBA225F2BBA039828E082342AD07C14EC82200","rx":"990290008E08FD43BC951F556ADF9000"}
{"type":"exchange","tx":"0CB0000000000E970200008E088B8AB08DF9D93DE20000","rx":"87820241017EC5779C32C45BA5F8737B21366E9D9BE01D522B7E11F8225DF497AEAC6F2D259C6E4170BFCD0947651C95389795A5209C07D4E1B933683D77AE75C89F30C4D153670825B8A21B2EC20FA11AB8B805125E48D0E76BDD38E8FB17ED52A21F2ECBC57D6857296EF3A363B30DDC46D235CD1226B11BA9A48A9207AF49ACBE859BC48FC4935F9753F83EAF21B606972642E789D1B6E8CDE2278B61D71AA38A3ED8C537B0CB527C5BE788BAF0E7F5248D773E806D13537322BFC568E44C32F429D4F94CF54F0E1268894D0BE2400BC2B730DA46BABD2CEC83314D1F7392C7A553B0954356E461DC6AA4374E3492B9F377D3FC52AFCD2012C9DCF6E30CFB2C9355EB1BDFD15DEF1341AA9C5BF0FC4ADCEDB99384BA9A5C4431D18B7349C477FE73A54DE616816F6D14D236D86AC3ABB328A15DC5A75D8F746C491E1BD4263415595DF68D86ED9D39311041A84E0BA58188CF4BDEB5C1DA33E47EEC164142F924D39618081BF1C8F1188AD6CE69656B23E04F7BE8175A6DA8EDFD6B99A0A11967B4532390CA62E0CD6A3F8E078AE5F0B9C966E5BE1A0671E8B28B7CF70C75C822CEF8691373763E4D3AD99B26C88B44FD1DAF9A3AD4EF54AAE41006AF4169ACCF04068019D643252BE49CFFC0BAC23E5F85061D0C1ACA63728C0A0D7F51C1BB35D57D8680EF7DFDD5EEF0C6AA5B9B1EDA1E9429FABFB339EBB928865B8529027D112591982D406A6C696723142A88008D5A3903CA56A4C218AB721B459495E5E38AFA65186D7B2CA071C718278A0D33BFFBF8D07335DEFFEF9EDB767C31E0ED69C2267F990290008E08D9D897FA65B91AB19000"}
{"type":"exchange","tx":"0CB0023000000E970200008E0840E3D502BA7BEEC40000","rx":"99026B008E08CEAEC41F71FE11006B00"}
"#;

const JSONL_READ_CERTS: &str = r#"{"type":"header","version":1,"supports_extended_length":true,"keys":["4D5F4BFF85CA50E39F0114EF2435DB775FC8868B43626A8CCDD615CCF3282F73","2C083AE5324DD03C85D0D3F383BFEFE0572CA8DD1257BABBEB07EC78F7291411"],"can":"123123"}
{"type":"exchange","tx":"00A4040400","rx":"6282015A82017883023F008A01058407D2760001448000A181FA9103010501AB81908F0480FA0000A03CAF32A02BB4199501307F4C1306082A8214004C048119530700800000000000B406950130830114B406950130830118B803950110A40695010883011F8F04808400008C02808290008F0410EA00008F0400EA0000AF32A02BB406950130830113B406950130830118B4199501307F4C1306082A8214004C048119530700800000000000B8039501109103020501AB5B8F0410EA00008F0400EA0000AF32A02BB406950130830113B406950130830118B4199501307F4C1306082A8214004C048119530700800000000000B8039501108F0480840000AF9000"}
{"type":"exchange","tx":"00B09100000000","rx":"EF2BC003020000C103040502C210545359534954434F5345433230020400C403010000C503020000C7030100009000"}
{"type":"exchange","tx":"00A4020C02011C","rx":"9000"}
{"type":"exchange","tx":"00B00000000000","rx":"31143012060A04007F0007020204020202010202010D9000"}
{"type":"exchange","tx":"0022C1A40F800A04007F00070202040202830102","rx":"9000"}
{"type":"exchange","tx":"108600000000027C000000","rx":"7C128010F70069BFE00A16140898D1B78D0900A69000"}
{"type":"exchange","tx":"108600000000457C438141048686AE63A98DFD0440AA50D15F034045DC087B90EDE900C3E4C799EBFD5484D026F59460F06241CC9B292432B3A81272362273B949383F9B5BE8971220A0F7E80000","rx":"7C438241043FFBFDFD08DF83D269776D52C5EA3493BD817C470E8A232AFE31B7F2E0D37FC8262273F78418397103C38B8B3E5A11FF232E79FDC09A763B6FB67C97DB7008A89000"}
{"type":"exchange","tx":"108600000000457C4383410480995EACF17B02293F89D6E5F1AD0E33AF95E52936F7524FDEAD270E03FAA3FC553F8031056D8D58596BB4DBC2FFB19D632962AFD7C9BD1DB6F5A1D0D171D3520000","rx":"7C43844104615A1D260C2587417BD806EC3567D5B291BD982B563DA98E6155884A6CD3F7471FE5CB6DF898F76AAB0129106527972E1500A0D8B262F2CD97B944489D6113699000"}
{"type":"exchange","tx":"0086000000000C7C0A8508B02FE3F56876566C0000","rx":"7C0A860872892BEB5BFEDD039000"}
{"type":"exchange","tx":"0CA4040C1D871101B7781886BB51BAF5F19226D2E1268C1A8E082E43AC906ACF850300","rx":"990290008E088FACD57CEC0275419000"}
{"type":"exchange","tx":"0CA4020400002187110177B90A95309DF427EF1112D3DB2FD62D970200008E0858A99AD65849F8600000","rx":"818201606282015C8002076C8201418302C5048801208A0105C502036EA18201439103010501AB7D8F0400E400008C02000E8C02800EA02BB406950130830113B406950130830118B4199501307F4C1306082A8214004C0481195307008000000000008C0200D68C0200D0AF32A02BB406950130830113B406950130830118B4199501307F4C1306082A8214004C048119530700800000000000B8039501108C0200B090009103020501AB81B78F0400E400008C02000E8C02800EA02BB406950130830113B406950130830118B4199501307F4C1306082A8214004C0481195307008000000000008C0200D68C0200D0AF32A02BB406950130830113B406950130830118B4199501307F4C1306082A8214004C048119530700800000000000B8039501108C0200B0AF3AA033B406950130830102B406950130830113B406950130830118B4199501307F4C1306082A8214004C048119530700800000000000B803950120990290008E08FD32FD1010B589D19000"}
{"type":"exchange","tx":"0CB0000000000E970200008E08BE5FAEB5DDAAB78D0000","rx":"878203710105FF77452EDFFB3947C299A9A0DFF7DC4015BBC9F5B44B5BA0F48CA170FD84355842F68BFB8ED4CDE7856D0EAF7EC064E6DD74A62887911D0A17E88352A2AECF42CBF3FD4D7B9FE57939C71F5467D782E60BCAB3FC8CE0C46D649F45B603B043FA7A748C0DC57C76F4239A87B20656B673F6E3526BF2DA7F63D28FEAD9B5AA2C4465691DB5FC45A7B264191E655BD409F2BB6CE6742A75C614945F991FEAABA6AD2A462EAF621A7602F7603DA25E944C89EC8868DBE9B230D23B585A0B73FBB133040877F5F16FDD6FFB484C1C58296E52A3341EFCB5FB4EF7C8B96238EB0F67C08061320A98ED53FD37A3A74CC8B89D6AFD0BC9A16D886CE304037EB5A1CC7AF6A1386B4A6217F8118717C3A20BE62C4B93DE2686C6B969459A4CD2D86653C97C00D06F916DC539D36B9EF9A08C60AE492E24BB67DABB42E0722009B000C902837A5388E6543C126D86D86262D5D7C7469082D49653771862D45C15505B84439F4FA36B6C395F9E2B95387BAB21C852080F68A1343DE738AF9957CF29702929DFF1E70AE2AA0A36A1EA11A1CBBC9956C151D8166AED11D898A594466C90257B6547B8BEF462E9ECE7C9ED3C09458E6B6DB2BD044CA3D092C0F1E5F02FC38D64E77568BA1CE114749E23DD8B2211F4F8572E3591ABD80A59F7C6398F32DFE5D1345234D49E36DF7070B60BA7034581A4A55F75663C8FD58252FC26395A2EDFE891AAFC7FBA384922FEC683AB5D4112AA0ED7372EADFCE3D6B2B55F0EE11931ADEFFB758354633E53462C5791638261756E42275E52C836356965C32FBC43D905199BE0107259086EBA5E60FF55BF6883E87AC744E0E847597CBCE358E677928F724B77D5E79055B5F316CB2CEFE4CE1C81D787F7E9C929A087D74AF82DA1DBA7D0E79DD9F8DCE571D75902849A7B2A8050F8B2B20ED4FAC6E4C35499FDC682F0BC5DC66A55946C80AA21F944AF43112687C05866FE9FC0397B17D0F65AB90CDE27083E03502B062EB37ED73AA2A846C1DC3DA757AB00046422ED71E7815F361A261BD004196C6567BD1AF8614CA02E6564657D81F377EB1F16BEF0432C25E64CB6E7B466F23033BAEA3AF9878590BB6C4F1194F0CA17AAF81E15F9BDF974352C7764358001FAA81873508E5E2BDA251570147D41762B9843C0EBEA0ECBC46CDAC85D8F80AC45A4E378804A693F139ACC1DF6C61290B607BE0CC9D0B25AA78E86FFAB95FF1B05646AAE2A17D7C33B44C9990290008E08AA8C9EF1B713CFD99000"}
{"type":"exchange","tx":"0CB0036E00000E970200008E081351FF558E7B626E0000","rx":"99026B008E08F32500B8E4FBDB3F6B00"}
{"type":"exchange","tx":"0CA4040C0A8E08354BC7B5B20CF74000","rx":"990290008E08C169CC8DE3DD9BE69000"}
{"type":"exchange","tx":"0CA4020400002187110170F7CEDE3FCBA65394A62D4013978E56970200008E081A082F825D1DB3A20000","rx":"8181DF6281DC800200DE82014183022F068801308A0105C50200DEA181C49103010501AB3E8C0200D6AF32A02BB406950130830113B406950130830118B4199501307F4C1306082A8214004C048119530700800000000000B8039501108C0200B090009103020501AB788C0200D6AF32A02BB406950130830113B406950130830118B4199501307F4C1306082A8214004C048119530700800000000000B8039501108C0200B0AF3AA033B406950130830102B406950130830113B406950130830118B4199501307F4C1306082A8214004C048119530700800000000000B803950120990290008E089C35FDD385E05B6C9000"}
{"type":"exchange","tx":"0CB0000000000E970200008E0887387AA5CA9645D90000","rx":"8781E101AE30F59BA10E95B0D85EEE2012D1C7F9F90FA61E2EFE41E8C9A9E4F29CF02A6F75338C515DBFE5914A04BE9C09E34018BA42904ACA08B685A4B82DBE1951CF24093DBEB76CAC0A366FBE1D5D7B6EE0C57DF45195B1B6F85F2304ABF0D024D9E9CC175CE1F78C8E0F3763AEA629E8762C9DF5D3785C973205505A636C84FBA98090715AABD37EE6CA9F88AA245239BEF3793F84FE4AC70780ADBA87E9A9D04475464E3A14A7B82FAE10C9DD33E537772580594C9C2D947F1DCB69945386380D540B75D63E0670A816632FC5117F9DADA8B14F99450BE603AD89FCF9237AA8E888990290008E0820845A9B752CE17E9000"}
{"type":"exchange","tx":"0CB000DE00000E970200008E088FF7D739680248F10000","rx":"99026B008E08CDABC5D67FC9796A6B00"}
"#;
